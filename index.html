<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ReserVue</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link href="./images/favicon.ico" rel="icon" type="image/x-icon" />
    <script src="https://unpkg.com/vue@2.7.8/dist/vue.js"></script>
  </head>

  <body>
    <div id="app">
      <!-- Navigation bar -->
      <nav id="navbar">
        <h1 id="website-title">ReserVue</h1>
        <div class="search-bar">
          <input
            placeholder="Search for a lesson"
            v-model="searchQuery"
            @input="searchlessons()"
          />
          <button id="search-button" @click="clearSearch()">Clear</button>
        </div>

        <div id="top-links">
          <img
            src="./images/home.svg"
            class="nav-icon"
            id="home"
            @click="goHome()"
          />
          <img
            src="./images/moon.svg"
            class="nav-icon"
            id="toggle-mode"
            @click="toggleMode()"
          />
          <button :disabled="cart.length === 0 ">
            <img
              src="./images/cart.svg"
              class="cart-icon"
              id="cart"
              @click="cart.length > 0 && viewCart()"
            />
          </button>
        </div>
      </nav>

      <!-- System message that will be displayed after certain operations -->
      <div id="system-message" v-if="systemMessage">{{systemMessage}}</div>

      <!-- Home section -->
      <div id="home" v-if="homeOpen">
        <h1>List of lessons</h1>
        <div id="home-container">
          <!-- Filters and sorting for the lessons -->
          <div id="lesson-filter-container">
            <h2>Category</h2>
            <input
              type="radio"
              name="category"
              value="All"
              checked
              @click="filterLessons('All')"
            />
            <label>All</label><br />
            <input
              type="radio"
              name="category"
              value="subject"
              @click="filterLessons('subject')"
            />
            <label>Subject</label><br />
            <input
              type="radio"
              name="category"
              value="location"
              @click="filterLessons('location')"
            />
            <label>Location</label><br />
            <input
              type="radio"
              name="category"
              value="price"
              @click="filterLessons('price')"
            />
            <label>Price</label><br />
            <input
              type="radio"
              name="category"
              value="spaces"
              @click="filterLessons('spaces')"
            />
            <label>Spaces</label><br />

            <h2>Sort by</h2>
            <input
              type="radio"
              value="Ascending"
              name="sortby"
              checked
              @click="sortlessons('Asc')"
            />
            <label for="html">Ascending</label><br />
            <input
              type="radio"
              value="Descending"
              name="sortby"
              @click="sortlessons('Desc')"
            />
            <label for="css">Descending</label><br />
          </div>

          <!-- Displaying the products -->
          <div class="card-container">
            <div
              v-for="(lesson, idx) in paginatedlessons"
              :key="lesson.tutor"
              class="card"
              @click="viewlesson(lesson, 'home')"
            >
              <div class="lesson-details">
                <div class="lesson-details-container">
                  <p><strong>Tutor:</strong> {{lesson.tutor}}</p>
                  <p><strong>Subject:</strong> {{lesson.subject}}</p>
                  <p><strong>Location:</strong> {{lesson.location}}</p>
                  <p><strong>Price:</strong> Â£{{lesson.price}}</p>
                  <p><strong>Spaces:</strong> {{lesson.spaces}}</p>
                </div>
                <div class="card-img-container">
                  <img :src="`${lesson.images}`" />
                </div>
              </div>
              <button
                class="add-button"
                :disabled="  lesson.spaces==0 "
                @click.stop="addToCart(lesson)"
              >
                <img
                  src="./images/cart-light.svg"
                  class="card-icon"
                  id="card-cart"
                />
              </button>
            </div>
          </div>
        </div>

        <div class="lesson-navigation">
          <button :disabled="currentPage<=1" @click="goToPreviousPage">
            &larr; Previous
          </button>
          <p>{{currentPage}}</p>
          <button
            :disabled="currentPage>=lessons.length/9"
            @click="goToNextPage"
          >
            Next &rarr;
          </button>
        </div>
      </div>

      <!-- Cart page -->
      <div v-if="cartOpen" id="cart-section">
        <h1>Cart</h1>
        <div v-if="cart.length==0" id="empty-cart">
          <p>Your cart is empty</p>
        </div>
        <div v-else class="cart-container">
          <div v-for="(lesson, idx) in cart" :key="lesson.tutor" class="card">
            <div class="lesson-details">
              <div class="lesson-details-container">
                <p><strong>Tutor:</strong> {{lesson.tutor}}</p>
                <p><strong>Subject:</strong> {{lesson.subject}}</p>
                <p><strong>Location:</strong> {{lesson.location}}</p>
                <p><strong>Price:</strong> Â£{{lesson.price}}</p>
                <p><strong>Spaces:</strong> {{lesson.spaces}}</p>
              </div>
              <div class="card-img-container">
                <img :src="`${lesson.images}`" />
              </div>
            </div>
            <button class="remove-button" @click.stop="removeItem(lesson)">
              <img src="./images/remove.svg" class="card-icon" id="card-cart" />
            </button>
          </div>
        </div>
        <p id="displayed-total"><strong>Total:</strong> ${{total}}</p>
        <hr />

        <!-- Checkout section -->
        <div v-if="cart.length!=0" id="cart-footer">
          <h1>Checkout</h1>
          <div id="payment-details">
            <label for="name">Name:</label>
            <input
              type="text"
              id="name"
              placeholder="John"
              v-model="name"
              required
            />

            <label for="phone">Phone:</label>
            <input
              type="text"
              id="phone-no"
              placeholder="12345678"
              required
              v-model="phoneNo"
            />
          </div>
          <button
            @click="checkout()"
            id="checkout-button"
            :disabled="!name || !phoneNo"
          >
            ðŸ›’Checkout
          </button>
        </div>
      </div>

      <!-- Lesson details page -->
      <div v-if="lessonOpen" id="lesson-section">
        <button class="back-button" @click="exitlessonPage()">
          &larr;Back
        </button>
        <h1>Lesson information</h1>
        <div id="lesson-info">
          <img
            id="lesson-image"
            :src="`${displayedLesson.images}`"
            alt="lesson Image"
          />
          <div id="lesson-description">
            <h1>
              {{ displayedLesson.subject }} lesson by {{ displayedLesson.tutor
              }}
            </h1>
            <hr />
            <p>{{ displayedLesson.description}}</p>
          </div>
        </div>
        <div id="lesson-buttons">
          <p><strong>Price:</strong> Â£{{displayedLesson.price}}</p>
          <p><strong>Spaces:</strong> {{displayedLesson.spaces}}</p>

          <div id="action-buttons">
            <button
              id="add-to-cart-btn"
              :class="{ 'disabled-btn': displayedLesson.spaces==0 }"
              @click="addToCart(displayedLesson)"
            >
              ðŸ›’Add to cart
            </button>
          </div>
        </div>
      </div>

      <!-- Search results page -->
      <div id="search-results" v-if="searchOpen">
        <h1 v-if="searchResult.length==0">No lesson found!</h1>
        <h1 v-else>Search results</h1>
        <div v-if="searchResult.length>0" class="search-container">
          <div
            v-for="(lesson, idx) in paginatedSearchResults"
            :key="lesson.tutor"
            class="card"
            @click="viewlesson(lesson, 'search')"
          >
            <div class="lesson-details">
              <div class="lesson-details-container">
                <p><strong>Tutor:</strong> {{lesson.tutor}}</p>
                <p><strong>Subject:</strong> {{lesson.subject}}</p>
                <p><strong>Location:</strong> {{lesson.location}}</p>
                <p><strong>Price:</strong> Â£{{lesson.price}}</p>
                <p><strong>Spaces:</strong> {{lesson.spaces}}</p>
              </div>
              <div class="card-img-container">
                <img :src="`${lesson.images}`" />
              </div>
            </div>
            <button
              class="add-button"
              :disabled="  lesson.spaces==0 "
              @click.stop="addToCart(lesson)"
            >
              <img
                src="./images/cart-light.svg"
                class="card-icon"
                id="card-cart"
              />
            </button>
          </div>
        </div>
        <div class="lesson-navigation" v-if="searchResult.length>0">
          <button :disabled="currentPage <= 1" @click="goToPreviousPage">
            &larr; Previous
          </button>
          <p>{{currentPage}}</p>
          <button
            :disabled="currentPage >= totalSearchPages"
            @click="goToNextPage"
          >
            Next &rarr;
          </button>
        </div>
      </div>
    </div>
    <script type="module" src="script.js"></script>
  </body>
</html>
